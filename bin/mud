#!/usr/bin/env php
<?php
declare(strict_types=1);

require_once __DIR__.'/../bootstrap.php';

use PhpMud\Entity\Room;
use PhpMud\Entity\Item;
use PhpMud\Entity\Mob;
use PhpMud\Enum\Material;
use PhpMud\Enum\Race;
use PhpMud\Server;

$roomRepository = $em->getRepository(Room::class);
$room = $roomRepository->find(1);

if (!$room) {
    echo "creating initial world fixtures\n";
    $room = new Room();
    $room->setTitle('Midgaard Town Center');
    $room->setDescription('Before you is the town center.');
    $room->getInventory()->add(new Item('a copper teapot', Material::COPPER(), ['copper', 'teapot']));
    $mob = new Mob('a janitor', Race::HUMAN());
    $mob->setRoom($room);
}

(new Server($em, $room))->listen($config['port']);